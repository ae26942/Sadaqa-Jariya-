<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>موقع إسلامي شامل</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap');
        
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f0fdf4;
            color: #166534;
            direction: rtl;
            text-align: right;
        }

        .amiri-font {
            font-family: 'Amiri', serif;
        }

        .tab-button.active {
            background-color: #166534;
            color: white;
        }

        .scroll-container {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .scroll-container::-webkit-scrollbar {
            display: none;
        }

        .prayer-time-box {
            background-color: #d1fae5;
            padding: 1rem;
            border-radius: 0.75rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .adhkar-item {
            background-color: #f0fdf4;
            padding: 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            transition: all 0.2s ease-in-out;
            cursor: pointer;
        }

        .adhkar-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .adhkar-item.completed {
            background-color: #d1fae5;
        }

        #quran-text-container p {
            line-height: 2.2;
            font-size: 1.5rem;
            text-align: justify;
        }
        
        .loading-spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #166534;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: auto;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col min-h-screen">
    <div class="container mx-auto p-4 flex-grow max-w-4xl">
        <header class="bg-green-700 text-white rounded-lg shadow-md p-4 text-center mb-6">
            <h1 class="text-3xl font-bold">موقع المسلم الشامل</h1>
            <p class="text-sm mt-2">نور في حياتك اليومية</p>
        </header>

        <nav class="bg-green-100 p-2 rounded-lg shadow-inner flex flex-wrap justify-center space-x-2 space-x-reverse mb-6">
            <button onclick="showSection('adhkar')" class="nav-button p-2 rounded-full text-sm font-medium transition-all hover:bg-green-200">الأذكار</button>
            <button onclick="showSection('quran')" class="nav-button p-2 rounded-full text-sm font-medium transition-all hover:bg-green-200">القرآن الكريم</button>
            <button onclick="showSection('duas')" class="nav-button p-2 rounded-full text-sm font-medium transition-all hover:bg-green-200">أدعية عامة</button>
            <button onclick="showSection('sadaqah')" class="nav-button p-2 rounded-full text-sm font-medium transition-all hover:bg-green-200">صدقة جارية</button>
            <button onclick="showSection('prayers')" class="nav-button p-2 rounded-full text-sm font-medium transition-all hover:bg-green-200">مواقيت الصلاة</button>
        </nav>

        <!-- Section 1: Adhkar -->
        <main id="adhkar" class="section">
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-2xl font-bold mb-4 text-green-700">أذكار المسلم</h2>
                <div class="flex flex-wrap justify-center gap-4 mb-4">
                    <button id="morning-adhkar-btn" class="tab-button bg-gray-200 text-gray-700 font-bold py-2 px-4 rounded-lg transition-colors hover:bg-green-700 hover:text-white">أذكار الصباح</button>
                    <button id="evening-adhkar-btn" class="tab-button bg-gray-200 text-gray-700 font-bold py-2 px-4 rounded-lg transition-colors hover:bg-green-700 hover:text-white">أذكار المساء</button>
                </div>
                <div id="adhkar-list" class="space-y-6"></div>
            </div>
            <div id="alarm-message" class="fixed bottom-4 left-1/2 -translate-x-1/2 bg-green-700 text-white py-2 px-4 rounded-full text-sm hidden shadow-lg z-50">
                حان وقت أذكار <span id="alarm-type"></span>
            </div>
        </main>

        <!-- Section 2: Quran -->
        <main id="quran" class="section hidden">
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-2xl font-bold mb-4 text-green-700">القرآن الكريم</h2>
                <div class="flex flex-col items-center mb-6">
                    <label for="surah-select" class="text-lg font-medium mb-2">اختر السورة:</label>
                    <select id="surah-select" class="p-2 border rounded-lg w-full max-w-xs text-center"></select>
                </div>
                <div id="quran-content" class="text-center">
                    <p class="text-gray-500 amiri-font text-xl">اختر سورة من القائمة لتبدأ القراءة.</p>
                </div>
            </div>
        </main>

        <!-- Section 3: General Duas -->
        <main id="duas" class="section hidden">
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-2xl font-bold mb-4 text-green-700">أدعية عامة</h2>
                <div class="flex flex-wrap justify-center gap-2 mb-4">
                    <button onclick="showDuaTab('sadness')" class="tab-button bg-gray-200 text-gray-700 font-bold py-2 px-4 rounded-lg transition-colors hover:bg-green-700 hover:text-white active">أدعية الهم والحزن</button>
                    <button onclick="showDuaTab('livelihood')" class="tab-button bg-gray-200 text-gray-700 font-bold py-2 px-4 rounded-lg transition-colors hover:bg-green-700 hover:text-white">أدعية الرزق والسعادة</button>
                    <button onclick="showDuaTab('repentance')" class="tab-button bg-gray-200 text-gray-700 font-bold py-2 px-4 rounded-lg transition-colors hover:bg-green-700 hover:text-white">أدعية التوبة</button>
                    <button onclick="showDuaTab('protection')" class="tab-button bg-gray-200 text-gray-700 font-bold py-2 px-4 rounded-lg transition-colors hover:bg-green-700 hover:text-white">أدعية الحفظ</button>
                </div>
                <div id="duas-content" class="space-y-4"></div>
            </div>
        </main>

        <!-- Section 4: Sadaqah Jariyah -->
        <main id="sadaqah" class="section hidden">
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-2xl font-bold mb-4 text-green-700">صدقة جارية للمتوفى</h2>
                <div class="space-y-6">
                    <div>
                        <h3 class="text-xl font-bold text-green-800 mb-2">أدعية للمتوفى</h3>
                        <div id="deceased-duas-list" class="space-y-4"></div>
                        <div class="mt-4 p-4 bg-green-50 rounded-lg shadow-inner">
                            <p class="text-sm text-green-900 font-bold">استغفار للمتوفى:</p>
                            <div class="flex justify-between items-center mt-2">
                                <span id="istighfar-counter" class="text-3xl font-extrabold text-green-700">0</span>
                                <button onclick="incrementIstighfar()" class="py-2 px-6 bg-green-700 text-white rounded-full shadow-lg transition-transform transform hover:scale-105">استغفر الله</button>
                                <button onclick="resetIstighfar()" class="py-1 px-3 bg-gray-300 text-gray-700 rounded-full text-sm hover:bg-gray-400">إعادة</button>
                            </div>
                        </div>
                        <p class="mt-4 p-4 bg-gray-100 rounded-lg text-sm text-gray-600">
                            آداب زيارة القبور: يُستحبّ عند زيارة القبور أن يُسلّم الزائر على أهل القبور، وأن يدعو لهم بالمغفرة والرحمة، وأن يتذكّر الموت والآخرة.
                        </p>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-green-800 mb-2">سور قرآنية للميت</h3>
                        <div id="deceased-surahs-list" class="space-y-4"></div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Section 5: Prayer Times -->
        <main id="prayers" class="section hidden">
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-2xl font-bold mb-4 text-green-700">مواقيت الصلاة</h2>
                <div id="prayer-times-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                <div id="next-prayer-info" class="mt-6 text-center text-lg font-semibold text-green-800 p-4 bg-green-50 rounded-lg shadow-inner"></div>
            </div>
        </main>
    </div>

    <!-- Footer -->
    <footer class="bg-green-900 text-white p-4 text-center mt-6">
        <p class="text-sm">أرجوا الدعاء لمطور التطبيق بالعفو والعافية، آمين</p>
        <p class="text-xs mt-2">للتواصل أو التبرع: 
            <a href="https://wa.me/+201550243338" target="_blank" class="text-green-300 hover:underline">
                wa.me/+201550243338
            </a>
        </p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            showSection('adhkar');
            initAdhkar();
            initQuran();
            initDuas();
            initSadaqah();
            initPrayerTimes();
        });

        function showSection(sectionId) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(sec => sec.classList.add('hidden'));
            document.getElementById(sectionId).classList.remove('hidden');
        }

        // --- Adhkar Section ---
        const adhkar = {
            morning: [
                { text: "أَعُوذُ بِاللهِ مِنَ الشَّيطَانِ الرَّجِيمِ. اللَّهُ لَا إِلَهَ إِلَّا هُوَ الْحَيُّ الْقَيُّومُ لَا تَأْخُذُهُ سِنَةٌ وَلَا نَوْمٌ لَهُ مَا فِي السَّمَاوَاتِ وَمَا فِي الْأَرْضِ مَنْ ذَا الَّذِي يَشْفَعُ عِنْدَهُ إِلَّا بِإِذْنِهِ يَعْلَمُ مَا بَيْنَ أَيْدِيهِمْ وَمَا خَلْفَهُمْ وَلَا يُحِيطُونَ بِشَيْءٍ مِنْ عِلْمِهِ إِلَّا بِمَا شَاءَ وَسِعَ كُرْسِيُّهُ السَّمَاوَاتِ وَالْأَرْضَ وَلَا يَئُودُهُ حِفْظُهُمَا وَهُوَ الْعَلِيُّ الْعَظِيمُ.", count: 1 },
                { text: "بِسْمِ اللهِ الرَّحْمَنِ الرَّحِيمِ. قُلْ هُوَ اللَّهُ أَحَدٌ، اللَّهُ الصَّمَدُ، لَمْ يَلِدْ وَلَمْ يُولَدْ، وَلَمْ يَكُنْ لَهُ كُفُوًا أَحَدٌ.", count: 3 },
                { text: "بِسْمِ اللهِ الرَّحْمَنِ الرَّحِيمِ. قُلْ أَعُوذُ بِرَبِّ الْفَلَقِ، مِنْ شَرِّ مَا خَلَقَ، وَمِنْ شَرِّ غَاسِقٍ إِذَا وَقَبَ، وَمِنْ شَرِّ النَّفَّاثَاتِ فِي الْعُقَدِ، وَمِنْ شَرِّ حَاسِدٍ إِذَا حَسَدَ.", count: 3 },
                { text: "بِسْمِ اللهِ الرَّحْمَنِ الرَّحِيمِ. قُلْ أَعُوذُ بِرَبِّ النَّاسِ، مَلِكِ النَّاسِ، إِلَهِ النَّاسِ، مِنْ شَرِّ الْوَسْوَاسِ الْخَنَّاسِ، الَّذِي يُوَسْوِسُ فِي صُدُورِ النَّاسِ، مِنَ الْجِنَّةِ وَالنَّاسِ.", count: 3 },
                { text: "أَصْبَحْنَا وَأَصْبَحَ الْمُلْكُ لِلَّهِ، وَالْحَمْدُ لِلَّهِ، لاَ إِلَهَ إِلاَّ اللَّهُ وَحْدَهُ لاَ شَرِيكَ لَهُ، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ، رَبِّ أَسْأَلُكَ خَيْرَ مَا فِي هَذَا الْيَوْمِ وَخَيْرَ مَا بَعْدَهُ، وَأَعُوذُ بِكَ مِنْ شَرِّ مَا فِي هَذَا الْيَوْمِ وَشَرِّ مَا بَعْدَهُ، رَبِّ أَعُوذُ بِكَ مِنَ الْكَسَلِ وَسُوءِ الْكِبَرِ، رَبِّ أَعُوذُ بِكَ مِنْ عَذَابٍ فِي النَّارِ وَعَذَابٍ فِي الْقَبْرِ.", count: 1 },
                { text: "اللَّهُمَّ بِكَ أَصْبَحْنَا، وَبِكَ أَمْسَيْنَا، وَبِكَ نَحْيَا، وَبِكَ نَمُوتُ وَإِلَيْكَ النُّشُورُ.", count: 1 },
                { text: "اللَّهُمَّ أَنْتَ رَبِّي لاَ إِلَهَ إِلاَّ أَنْتَ، خَلَقْتَنِي وَأَنَا عَبْدُكَ، وَأَنَا عَلَى عَهْدِكَ وَوَعْدِكَ مَا اسْتَطَعْتُ، أَعُوذُ بِكَ مِنْ شَرِّ مَا صَنَعْتُ، أَبُوءُ لَكَ بِنِعْمَتِكَ عَلَيَّ، وَأَبُوءُ بِذَنْبِي فَاغْفِرْ لِي فَإِنَّهُ لاَ يَغْفِرُ الذُّنُوبَ إِلاَّ أَنْتَ.", count: 1 },
                { text: "اللَّهُمَّ إِنِّي أَصْبَحْتُ أُشْهِدُكَ، وَأُشْهِدُ حَمَلَةَ عَرْشِكَ، وَمَلاَئِكَتِكَ، وَجَمِيعَ خَلْقِكَ، أَنَّكَ أَنْتَ اللَّهُ لاَ إِلَهَ إِلاَّ أَنْتَ وَحْدَكَ لاَ شَرِيكَ لَكَ، وَأَنَّ مُحَمَّدًا عَبْدُكَ وَرَسُولُكَ.", count: 4 },
                { text: "اللَّهُمَّ مَا أَصْبَحَ بِي مِنْ نِعْمَةٍ أَوْ بِأَحَدٍ مِنْ خَلْقِكَ فَمِنْكَ وَحْدَكَ لاَ شَرِيكَ لَكَ، فَلَكَ الْحَمْدُ وَلَكَ الشُّكْرُ.", count: 1 },
                { text: "يَا حَيُّ يَا قَيُّومُ بِرَحْمَتِكَ أَسْتَغِيثُ أَصْلِحْ لِي شَأْنِي كُلَّهُ وَلَا تَكِلْنِي إِلَى نَفْسِي طَرْفَةَ عَيْنٍ.", count: 1 },
            ],
            evening: [
                { text: "أَعُوذُ بِاللهِ مِنَ الشَّيطَانِ الرَّجِيمِ. اللَّهُ لَا إِلَهَ إِلَّا هُوَ الْحَيُّ الْقَيُّومُ لَا تَأْخُذُهُ سِنَةٌ وَلَا نَوْمٌ لَهُ مَا فِي السَّمَاوَاتِ وَمَا فِي الْأَرْضِ مَنْ ذَا الَّذِي يَشْفَعُ عِنْدَهُ إِلَّا بِإِذْنِهِ يَعْلَمُ مَا بَيْنَ أَيْدِيهِمْ وَمَا خَلْفَهُمْ وَلَا يُحِيطُونَ بِشَيْءٍ مِنْ عِلْمِهِ إِلَّا بِمَا شَاءَ وَسِعَ كُرْسِيُّهُ السَّمَاوَاتِ وَالْأَرْضَ وَلَا يَئُودُهُ حِفْظُهُمَا وَهُوَ الْعَلِيُّ الْعَظِيمُ.", count: 1 },
                { text: "بِسْمِ اللهِ الرَّحْمَنِ الرَّحِيمِ. قُلْ هُوَ اللَّهُ أَحَدٌ، اللَّهُ الصَّمَدُ، لَمْ يَلِدْ وَلَمْ يُولَدْ، وَلَمْ يَكُنْ لَهُ كُفُوًا أَحَدٌ.", count: 3 },
                { text: "بِسْمِ اللهِ الرَّحْمَنِ الرَّحِيمِ. قُلْ أَعُوذُ بِرَبِّ الْفَلَقِ، مِنْ شَرِّ مَا خَلَقَ، وَمِنْ شَرِّ غَاسِقٍ إِذَا وَقَبَ، وَمِنْ شَرِّ النَّفَّاثَاتِ فِي الْعُقَدِ، وَمِنْ شَرِّ حَاسِدٍ إِذَا حَسَدَ.", count: 3 },
                { text: "بِسْمِ اللهِ الرَّحْمَنِ الرَّحِيمِ. قُلْ أَعُوذُ بِرَبِّ النَّاسِ، مَلِكِ النَّاسِ، إِلَهِ النَّاسِ، مِنْ شَرِّ الْوَسْوَاسِ الْخَنَّاسِ، الَّذِي يُوَسْوِسُ فِي صُدُورِ النَّاسِ، مِنَ الْجِنَّةِ وَالنَّاسِ.", count: 3 },
                { text: "أَمْسَيْنَا وَأَمْسَى الْمُلْكُ لِلَّهِ، وَالْحَمْدُ لِلَّهِ، لاَ إِلَهَ إِلاَّ اللَّهُ وَحْدَهُ لاَ شَرِيكَ لَهُ، لَهُ الْمُلْكُ وَلَهُ الْحَمْدُ وَهُوَ عَلَى كُلِّ شَيْءٍ قَدِيرٌ، رَبِّ أَسْأَلُكَ خَيْرَ مَا فِي هَذِهِ اللَّيْلَةِ وَخَيْرَ مَا بَعْدَهَا، وَأَعُوذُ بِكَ مِنْ شَرِّ مَا فِي هَذِهِ اللَّيْلَةِ وَشَرِّ مَا بَعْدَهَا، رَبِّ أَعُوذُ بِكَ مِنَ الْكَسَلِ وَسُوءِ الْكِبَرِ، رَبِّ أَعُوذُ بِكَ مِنْ عَذَابٍ فِي النَّارِ وَعَذَابٍ فِي الْقَبْرِ.", count: 1 },
                { text: "اللَّهُمَّ بِكَ أَمْسَيْنَا، وَبِكَ أَصْبَحْنَا، وَبِكَ نَحْيَا، وَبِكَ نَمُوتُ وَإِلَيْكَ الْمَصِيرُ.", count: 1 },
                { text: "اللَّهُمَّ أَنْتَ رَبِّي لاَ إِلَهَ إِلاَّ أَنْتَ، خَلَقْتَنِي وَأَنَا عَبْدُكَ، وَأَنَا عَلَى عَهْدِكَ وَوَعْدِكَ مَا اسْتَطَعْتُ، أَعُوذُ بِكَ مِنْ شَرِّ مَا صَنَعْتُ، أَبُوءُ لَكَ بِنِعْمَتِكَ عَلَيَّ، وَأَبُوءُ بِذَنْبِي فَاغْفِرْ لِي فَإِنَّهُ لاَ يَغْفِرُ الذُّنُوبَ إِلاَّ أَنْتَ.", count: 1 },
                { text: "اللَّهُمَّ إِنِّي أَمْسَيْتُ أُشْهِدُكَ، وَأُشْهِدُ حَمَلَةَ عَرْشِكَ، وَمَلاَئِكَتِكَ، وَجَمِيعَ خَلْقِكَ، أَنَّكَ أَنْتَ اللَّهُ لاَ إِلَهَ إِلاَّ أَنْتَ وَحْدَكَ لاَ شَرِيكَ لَكَ، وَأَنَّ مُحَمَّدًا عَبْدُكَ وَرَسُولُكَ.", count: 4 },
                { text: "اللَّهُمَّ مَا أَمْسَى بِي مِنْ نِعْمَةٍ أَوْ بِأَحَدٍ مِنْ خَلْقِكَ فَمِنْكَ وَحْدَكَ لاَ شَرِيكَ لَكَ، فَلَكَ الْحَمْدُ وَلَكَ الشُّكْرُ.", count: 1 },
                { text: "يَا حَيُّ يَا قَيُّومُ بِرَحْمَتِكَ أَسْتَغِيثُ أَصْلِحْ لِي شَأْنِي كُلَّهُ وَلَا تَكِلْنِي إِلَى نَفْسِي طَرْفَةَ عَيْنٍ.", count: 1 },
            ]
        };
        const adhkarListContainer = document.getElementById('adhkar-list');
        const morningAdhkarBtn = document.getElementById('morning-adhkar-btn');
        const eveningAdhkarBtn = document.getElementById('evening-adhkar-btn');

        function renderAdhkar(type) {
            adhkarListContainer.innerHTML = '';
            adhkar[type].forEach((dhikr, index) => {
                const dhikrCard = document.createElement('div');
                dhikrCard.className = 'adhkar-item bg-green-50 p-4 rounded-lg shadow-inner';
                dhikrCard.innerHTML = `
                    <p class="text-lg mb-2 amiri-font">${dhikr.text}</p>
                    <div class="flex items-center justify-between mt-2">
                        <span id="counter-${index}" class="text-xl font-bold text-green-700">0 / ${dhikr.count}</span>
                        <button onclick="incrementCounter(${index}, ${dhikr.count})" class="py-1 px-4 bg-green-700 text-white rounded-full shadow-md hover:bg-green-800">سبِّح</button>
                    </div>
                `;
                adhkarListContainer.appendChild(dhikrCard);
            });
        }

        function incrementCounter(index, maxCount) {
            const counterElement = document.getElementById(`counter-${index}`);
            let [current, total] = counterElement.innerText.split(' / ').map(Number);
            if (current < total) {
                current++;
                counterElement.innerText = `${current} / ${total}`;
                if (current === total) {
                    counterElement.closest('.adhkar-item').classList.add('completed');
                }
            }
        }

        function initAdhkar() {
            morningAdhkarBtn.onclick = () => {
                morningAdhkarBtn.classList.add('active');
                eveningAdhkarBtn.classList.remove('active');
                renderAdhkar('morning');
            };
            eveningAdhkarBtn.onclick = () => {
                eveningAdhkarBtn.classList.add('active');
                morningAdhkarBtn.classList.remove('active');
                renderAdhkar('evening');
            };
            morningAdhkarBtn.click();
            setupAdhkarAlarms();
        }

        function setupAdhkarAlarms() {
            function showAlarm(type) {
                const alarmMessage = document.getElementById('alarm-message');
                const alarmType = document.getElementById('alarm-type');
                alarmType.innerText = type;
                alarmMessage.classList.remove('hidden');
                setTimeout(() => {
                    alarmMessage.classList.add('hidden');
                }, 10000);
            }

            const now = new Date();
            const morningAlarmTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 6, 0, 0);
            const eveningAlarmTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 18, 0, 0);

            function scheduleAlarm(alarmTime, type) {
                const now = new Date();
                let timeToAlarm = alarmTime.getTime() - now.getTime();
                if (timeToAlarm < 0) {
                    alarmTime.setDate(alarmTime.getDate() + 1);
                    timeToAlarm = alarmTime.getTime() - now.getTime();
                }
                setTimeout(() => {
                    showAlarm(type);
                    scheduleAlarm(new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1, alarmTime.getHours(), alarmTime.getMinutes(), 0), type);
                }, timeToAlarm);
            }

            scheduleAlarm(morningAlarmTime, 'الصباح');
            scheduleAlarm(eveningAlarmTime, 'المساء');
        }

        // --- Quran Section ---
        const surahNames = [
            "الفاتحة", "البقرة", "آل عمران", "النساء", "المائدة", "الأنعام", "الأعراف", "الأنفال", "التوبة", "يونس",
            "هود", "يوسف", "الرعد", "إبراهيم", "الحجر", "النحل", "الإسراء", "الكهف", "مريم", "طه",
            "الأنبياء", "الحج", "المؤمنون", "النور", "الفرقان", "الشعراء", "النمل", "القصص", "العنكبوت", "الروم",
            "لقمان", "السجدة", "الأحزاب", "سبأ", "فاطر", "يس", "الصافات", "ص", "الزمر", "غافر",
            "فصلت", "الشورى", "الزخرف", "الدخان", "الجاثية", "الأحقاف", "محمد", "الفتح", "الحجرات", "ق",
             "الذاريات", "الطور", "النجم", "القمر", "الرحمن", "الواقعة", "الحديد", "المجادلة", "الحشر", "الممتحنة",
            "الصف", "الجمعة", "المنافقون", "التغابن", "الطلاق", "التحريم", "الملك", "القلم", "الحاقة", "المعارج",
            "نوح", "الجن", "المزمل", "المدثر", "القيامة", "الإنسان", "المرسلات", "النبأ", "النازعات", "عبس",
            "التكوير", "الانفطار", "المطففين", "الانشقاق", "البروج", "الطارق", "الأعلى", "الغاشية", "الفجر", "البلد",
            "الشمس", "الليل", "الضحى", "الشرح", "التين", "العلق", "القدر", "البينة", "الزلزلة", "العاديات",
            "القارعة", "التكاثر", "العصر", "الهمزة", "الفيل", "قريش", "الماعون", "الكوثر", "الكافرون", "النصر",
            "المسد", "الإخلاص", "الفلق", "الناس"
        ];
        const surahSelect = document.getElementById('surah-select');
        const quranContent = document.getElementById('quran-content');

        async function initQuran() {
            surahSelect.innerHTML = '<option value="">اختر سورة...</option>';
            surahNames.forEach((name, index) => {
                const option = document.createElement('option');
                option.value = index + 1;
                option.innerText = name;
                surahSelect.appendChild(option);
            });

            surahSelect.addEventListener('change', async (event) => {
                const surahNumber = event.target.value;
                if (surahNumber) {
                    quranContent.innerHTML = '<div class="loading-spinner"></div>';
                    try {
                        const response = await fetch(`https://api.alquran.cloud/v1/surah/${surahNumber}`);
                        const data = await response.json();
                        if (data.data && data.data.ayahs) {
                            renderSurah(data.data);
                        } else {
                            quranContent.innerHTML = '<p class="text-red-600">حدث خطأ في تحميل السورة. يرجى المحاولة مرة أخرى.</p>';
                        }
                    } catch (error) {
                        console.error('Error fetching surah:', error);
                        quranContent.innerHTML = '<p class="text-red-600">فشل الاتصال. تأكد من اتصالك بالإنترنت.</p>';
                    }
                } else {
                    quranContent.innerHTML = '<p class="text-gray-500 amiri-font text-xl">اختر سورة من القائمة لتبدأ القراءة.</p>';
                }
            });
        }

        function renderSurah(surah) {
            let htmlContent = `<div class="bg-green-50 p-4 rounded-lg shadow-inner amiri-font">`;
            if (surah.number !== 1 && surah.number !== 9) {
                htmlContent += `<p class="text-2xl font-bold mb-4 text-green-900 text-center">بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ</p>`;
            }
            surah.ayahs.forEach(ayah => {
                htmlContent += `<span class="text-2xl">${ayah.text} <sup class="text-green-700 font-bold">${ayah.numberInSurah}</sup></span> `;
            });
            htmlContent += `</div>`;
            quranContent.innerHTML = htmlContent;
        }

             // --- General Duas Section ---
        const duasData = {
            sadness: [
                "1. اللهم إني أعوذ بك من الهم والحزن، والعجز والكسل، والبخل والجبن، وضلع الدين وغلبة الرجال.",
                "2. اللهم رحمتك أرجو فلا تكلني إلى نفسي طرفة عين، وأصلح لي شأني كله، لا إله إلا أنت.",
                "3. لا إله إلا الله العظيم الحليم، لا إله إلا الله رب العرش العظيم، لا إله إلا الله رب السماوات ورب الأرض ورب العرش الكريم.",
                "4. يا حي يا قيوم برحمتك أستغيث، أصلح لي شأني كله ولا تكلني إلى نفسي طرفة عين.",
                "5. اللهم إني عبدك ابن عبدك ابن أمتك ناصيتي بيدك ماض في حكمك عدل في قضاؤك أسألك بكل اسم هو لك سميت به نفسك أو أنزلته في كتابك أو علمته أحداً من خلقك أو استأثرت به في علم الغيب عندك أن تجعل القرآن العظيم ربيع قلبي ونور صدري وجلاء حزني وذهاب همي.",
                "6. اللهم إني أعوذ بك من العجز والكسل والجبن والبخل والهرم وعذاب القبر، اللهم آت نفسي تقواها وزكها أنت خير من زكاها أنت وليها ومولاها.",
                "7. رب اشرح لي صدري ويسر لي أمري واحلل عقدة من لساني يفقهوا قولي.",
                "8. لا إله إلا أنت سبحانك إني كنت من الظالمين.",
                "9. حسبي الله لا إله إلا هو عليه توكلت وهو رب العرش العظيم.",
                "10. اللهم لا سهل إلا ما جعلته سهلاً، وأنت تجعل الحزن إذا شئت سهلاً.",
                "11. اللهم إني أسألك خير المسألة، وخير الدعاء، وخير النجاح، وخير العمل، وخير الثواب، وخير الحياة، وخير الممات، وثبتني وثقل موازيني، وحقق إيماني، وارفع درجاتي، وتقبل صلاتي، واغفر خطيئتي، وأسألك الدرجات العلا من الجنة.",
                "12. اللهم إني أعوذ بك من العجز والكسل، والجبن والبخل، والهرم، وعذاب القبر، وفتنة المحيا والممات.",
                "13. اللهم يا جامع الناس ليوم لا ريب فيه اجمع بيني وبين سعادتي وتوفيقي وإلهامي.",
                "14. اللهم فرج همي ويسر أمري واصرف عني ما أحزنني.",
                "15. اللهم اكشف عني كل هم وغم، واغفر لي يا أرحم الراحمين.",
                "16. اللهم إني أعوذ بك من شر كل شيء أنت آخذ بناصيته.",
                "17. رب إني مسني الضر وأنت أرحم الراحمين.",
                "18. اللهم إني أسألك العافية في الدنيا والآخرة.",
                "19. اللهم إني أعوذ بك من شر ما في نفسي، ومن شر كل دابة أنت آخذ بناصيتها.",
                "20. اللهم الطف بي فيما جرت به المقادير."
            ],
            livelihood: [
                "1. اللهم مالك الملك تؤتي الملك من تشاء وتنزع الملك ممن تشاء، وتعز من تشاء وتذل من تشاء، بيدك الخير إنك على كل شيء قدير، رحمن الدنيا والآخرة ورحيمهما، تعطيهما من تشاء وتمنع منهما من تشاء، ارحمني رحمة تغنيني بها عن رحمة من سواك.",
                "2. اللهم اكفني بحلالك عن حرامك، وأغنني بفضلك عمن سواك.",
                "3. اللهم إني أسألك علماً نافعاً ورزقاً طيباً وعملاً متقبلاً.",
                "4. اللهم إن كان رزقي في السماء فأنزله وإن كان في الأرض فأخرجه وإن كان بعيداً فقربه وإن كان قريباً فيسره وإن كان قليلاً فكثره وإن كان كثيراً فبارك لي فيه.",
                "5. اللهم رب السماوات السبع ورب العرش العظيم اقض عنا الدين واغننا من الفقر.",
                "6. اللهم زدني مالاً وعلماً وبارك لي فيما رزقتني.",
                "7. يا كريم يا ودود، يا ذا العرش المجيد، يا فعّالاً لما تريد، أسألك بعزك الذي لا يرام، وبملكك الذي لا يضام، وبنورك الذي ملأ أركان عرشك، أن ترزقني رزقاً واسعاً حلالاً طيباً مباركاً فيه.",
                "8. اللهم إن كان رزقي في السماء فأنزله، وإن كان في الأرض فأخرجه، وإن كان بعيدًا فقربه، وإن كان قريبًا فيسره، وإن كان قليلاً فكثره، وإن كان كثيرًا فبارك لي فيه.",
                "9. اللهم إني أسألك من الخير كله عاجله وآجله، ما علمت منه وما لم أعلم، وأعوذ بك من الشر كله عاجله وآجله، ما علمت منه وما لم أعلم.",
                "10. اللهم اجعل لي من كل هم فرجا، ومن كل ضيق مخرجا، ومن كل بلاء عافية، ومن كل فقر غنى.",
                "11. اللهم إني أسألك من فضلك ورحمتك، فإنه لا يملكها إلا أنت.",
                "12. اللهم بارك لي في رزقي كله، وبارك لي في حياتي كلها.",
                "13. اللهم أسألك رزقًا طيبًا وعيشة هنية، وحياة سعيدة، وموتة هادئة.",
                "14. اللهم رب الناس، اذهب البأس، واشف أنت الشافي، لا شفاء إلا شفاؤك، شفاء لا يغادر سقمًا.",
                "15. اللهم رب السماوات السبع ورب العرش العظيم، ربنا ورب كل شيء، فالق الحب والنوى، ومنزل التوراة والإنجيل والفرقان، أعوذ بك من شر كل شيء أنت آخذ بناصيته.",
                "16. اللهم إني أسألك الهدى والتقى والعفاف والغنى.",
                "17. اللهم اغفر لي ذنوبي، ووسع لي في داري، وبارك لي في رزقي.",
                "18. اللهم اجعلني من عبادك الصالحين، الذين أنعمت عليهم برزقك الوفير.",
                "19. اللهم ارزقني من حيث لا أحتسب.",
                "20. اللهم إني أسألك الهدى والتقى والعفاف والغنى والفوز بالجنة والنجاة من النار."
            ],
            repentance: [
                "1. ربنا اغفر لنا ذنوبنا وإسرافنا في أمرنا وثبت أقدامنا وانصرنا على القوم الكافرين.",
                "2. اللهم أنت ربي لا إله إلا أنت، خلقتني وأنا عبدك، وأنا على عهدك ووعدك ما استطعت، أعوذ بك من شر ما صنعت، أبوء لك بنعمتك علي، وأبوء بذنبي فاغفر لي فإنه لا يغفر الذنوب إلا أنت.",
                "3. رب اغفر لي وارحمني وتب علي إنك أنت التواب الرحيم.",
                "4. أستغفر الله العظيم الذي لا إله إلا هو الحي القيوم وأتوب إليه.",
                "5. اللهم اغفر لي خطيئتي وجهلي وإسرافي في أمري وما أنت أعلم به مني.",
                "6. اللهم اغفر لي ذنبي كله، دقه وجله، وأوله وآخره، وعلانيته وسره.",
                "7. اللهم إني ظلمت نفسي ظلماً كثيراً، ولا يغفر الذنوب إلا أنت، فاغفر لي مغفرة من عندك وارحمني، إنك أنت الغفور الرحيم.",
                "8. رب اغفر لي، وتب علي، إنك أنت التواب الغفور.",
                "9. اللهم اغفر لي ما قدمت وما أخرت وما أسررت وما أعلنت وما أنت أعلم به مني.",
                "10. اللهم باعد بيني وبين خطاياي كما باعدت بين المشرق والمغرب.",
                "11. اللهم نقني من الخطايا كما ينقى الثوب الأبيض من الدنس.",
                "12. اللهم اغسلني من خطاياي بالماء والثلج والبرد.",
                "13. اللهم إني أستغفرك من كل ذنب تبت إليك منه ثم عدت فيه.",
                "14. اللهم اهدني وسددني، اللهم إني أسألك الهدى والسداد.",
                "15. اللهم إني أسألك التوبة والرجوع إليك، والمغفرة من عندك، والرحمة من فضلك.",
                "16. سبحانك اللهم وبحمدك، أشهد أن لا إله إلا أنت، أستغفرك وأتوب إليك.",
                "17. اللهم إني أسألك يا الله الواحد الأحد الصمد، أن تغفر لي ذنوبي إنك أنت الغفور الرحيم.",
                "18. اللهم يا مقلب القلوب ثبت قلبي على دينك، ويا مصرف القلوب صرف قلبي على طاعتك.",
                "19. رب اغفر لي خطيئتي وذنبي وإسرافي في أمري كله.",
                "20. اللهم إني تائب إليك فاقبل توبتي، واغسل حوبتي، وثبت حجتي."
            ],
            protection: [
                "1. أعوذ بكلمات الله التامات من شر ما خلق.",
                "2. اللهم إني أسألك العافية في الدنيا والآخرة، اللهم إني أسألك العفو والعافية في ديني ودنياي وأهلي ومالي.",
                "3. بسم الله الذي لا يضر مع اسمه شيء في الأرض ولا في السماء وهو السميع العليم.",
                "4. اللهم إني أعوذ بك من زوال نعمتك وتحول عافيتك وفجاءة نقمتك وجميع سخطك.",
                "5. اللهم احفظني من بين يدي ومن خلفي وعن يميني وعن شمالي ومن فوقي وأعوذ بعظمتك أن أغتال من تحتي.",
                "6. اللهم إني أعوذ بك من شر ما عملت ومن شر ما لم أعمل.",
                "7. اللهم إني أعوذ بك من البرص والجنون والجذام ومن سيء الأسقام.",
                "8. اللهم عافني في بدني، اللهم عافني في سمعي، اللهم عافني في بصري، لا إله إلا أنت.",
                "9. اللهم إني أعوذ بك من شر كل شيء أنت آخذ بناصيته.",
                "10. بسم الله توكلت على الله ولا حول ولا قوة إلا بالله.",
                "11. اللهم إني أسألك من فضلك ورحمتك، فإنه لا يملكها إلا أنت.",
                "12. اللهم إني أعوذ بك من فتنة النار وعذاب النار وفتنة القبر وعذاب القبر وشر فتنة الغنى وشر فتنة الفقر.",
                "13. اللهم إني أعوذ بك من شر سمعي ومن شر بصري ومن شر لساني ومن شر قلبي ومن شر منيي.",
                "14. اللهم اهدني فيمن هديت، وعافني فيمن عافيت، وتولني فيمن توليت، وبارك لي فيما أعطيت، وقني شر ما قضيت.",
                "15. اللهم إني أعوذ بك من التردي والهدم والغرق والحريق، وأعوذ بك أن يتخبطني الشيطان عند الموت، وأعوذ بك أن أموت في سبيلك مدبرًا، وأعوذ بك أن أموت لديغًا.",
                "16. اللهم إني أعوذ بك من الجوع فإنه بئس الضجيع، وأعوذ بك من الخيانة فإنها بئست البطانة.",
                "17. اللهم اجعل لي نورًا في قلبي ونورًا في قبري ونورًا في بصري ونورًا في سمعي.",
                "18. اللهم احفظني بالإسلام قائمًا، واحفظني بالإسلام قاعدًا، واحفظني بالإسلام راقدًا.",
                "19. اللهم إني أسألك خيرًا من كل خير أحاط به علمك، وأعوذ بك من كل شر أحاط به علمك.",
                "20. اللهم إني أسألك باسمك الأعظم الذي إذا دعيت به أجبت، أن تجعلني في حماك وحفظك."
            ]
        };
        const duasContentContainer = document.getElementById('duas-content');

        function showDuaTab(tabName) {
            const buttons = document.querySelectorAll('#duas .tab-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            document.querySelector(`#duas .tab-button[onclick="showDuaTab('${tabName}')"]`).classList.add('active');
            
            duasContentContainer.innerHTML = '';
            duasData[tabName].forEach(dua => {
                const duaCard = document.createElement('div');
                duaCard.className = 'bg-green-50 p-4 rounded-lg shadow-inner';
                duaCard.innerHTML = `<p class="amiri-font text-lg text-center">${dua}</p>`;
                duasContentContainer.appendChild(duaCard);
            });
        }

        function initDuas() {
            showDuaTab('sadness');
        }
          // --- Sadaqah Jariyah Section ---
        const deceasedDuas = [
            "اللهم اغفر له وارحمه وعافه واعف عنه، وأكرم نزله، ووسع مدخله، واغسله بالماء والثلج والبرد، ونقه من الذنوب والخطايا كما ينقى الثوب الأبيض من الدنس.",
            "اللهم اجعل قبره روضة من رياض الجنة، ولا تجعله حفرة من حفر النار.",
            "اللهم أنزل على قبره الضياء والنور والفسحة والسرور.",
            "اللهم ارحم جميع المسلمين والمسلمات والمؤمنين والمؤمنات الأحياء منهم والأموات."
        ];
        const deceasedSurahs = [
            { name: "الفاتحة", text: "بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ (1) الْحَمْدُ لِلَّهِ رَبِّ الْعَالَمِينَ (2) الرَّحْمَٰنِ الرَّحِيمِ (3) مَالِكِ يَوْمِ الدِّينِ (4) إِيَّاكَ نَعْبُدُ وَإِيَّاكَ نَسْتَعِينُ (5) اهْدِنَا الصِّرَاطَ الْمُسْتَقِيمَ (6) صِرَاطَ الَّذِينَ أَنْعَمْتَ عَلَيْهِمْ غَيْرِ الْمَغْضُوبِ عَلَيْهِمْ وَلَا الضَّالِّينَ (7)" },
            { name: "الملك", text: "تَبَارَكَ الَّذِي بِيَدِهِ الْمُلْكُ وَهُوَ عَلَىٰ كُلِّ شَيْءٍ قَدِيرٌ (1) الَّذِي خَلَقَ الْمَوْتَ وَالْحَيَاةَ لِيَبْلُوَكُمْ أَيُّكُمْ أَحْسَنُ عَمَلًا ۚ وَهُوَ الْعَزِيزُ الْغَفُورُ (2) الَّذِي خَلَقَ سَبْعَ سَمَاوَاتٍ طِبَاقًا ۖ مَّا تَرَىٰ فِي خَلْقِ الرَّحْمَٰنِ مِن تَفَاوُتٍ ۖ فَارْجِعِ الْبَصَرَ هَلْ تَرَىٰ مِن فُطُورٍ (3) ثُمَّ ارْجِعِ الْبَصَرَ كَرَّتَيْنِ يَنقَلِبْ إِلَيْكَ الْبَصَرُ خَاسِئًا وَهُوَ حَسِيرٌ (4) وَلَقَدْ زَيَّنَّا السَّمَاءَ الدُّنْيَا بِمَصَابِيحَ وَجَعَلْنَاهَا رُجُومًا لِّلشَّيَاطِينِ ۖ وَأَعْتَدْنَا لَهُمْ عَذَابَ السَّعِيرِ (5) وَلِلَّذِينَ كَفَرُوا بِرَبِّهِمْ عَذَابُ جَهَنَّمَ ۖ وَبِئْسَ الْمَصِيرُ (6) إِذَا أُلْقُوا فِيهَا سَمِعُوا لَهَا شَهِيقًا وَهِيَ تَفُورُ (7) تَكَادُ تَمَيَّزُ مِنَ الْغَيْظِ ۖ كُلَّمَا أُلْقِيَ فِيهَا فَوْجٌ سَأَلَهُمْ خَزَنَتُهَا أَلَمْ يَأْتِكُمْ نَذِيرٌ (8) قَالُوا بَلَىٰ قَدْ جَاءَنَا نَذِيرٌ فَكَذَّبْنَا وَقُلْنَا مَا نَزَّلَ اللَّهُ مِن شَيْءٍ إِنْ أَنتُمْ إِلَّا فِي ضَلَالٍ كَبِيرٍ (9) وَقَالُوا لَوْ كُنَّا نَسْمَعُ أَوْ نَعْقِلُ مَا كُنَّا فِي أَصْحَابِ السَّعِيرِ (10) فَاعْتَرَفُوا بِذَنبِهِمْ فَسُحْقًا لِّأَصْحَابِ السَّعِيرِ (11) إِنَّ الَّذِينَ يَخْشَوْنَ رَبَّهُم بِالْغَيْبِ لَهُم مَّغْفِرَةٌ وَأَجْرٌ كَبِيرٌ (12) وَأَسِرُّوا قَوْلَكُمْ أَوِ اجْهَرُوا بِهِ ۖ إِنَّهُ عَلِيمٌ بِذَاتِ الصُّدُورِ (13) أَلَا يَعْلَمُ مَنْ خَلَقَ وَهُوَ اللَّطِيفُ الْخَبِيرُ (14) هُوَ الَّذِي جَعَلَ لَكُمُ الْأَرْضَ ذَلُولًا فَامْشُوا فِي مَنَاكِبِهَا وَكُلُوا مِن رِّزْقِهِ ۖ وَإِلَيْهِ النُّشُورُ (15) أَأَنتُم مَّن فِي السَّمَاءِ أَن يَخْسِفَ بِكُمُ الْأَرْضَ فَإِذَا هِيَ تَمُورُ (16) أَمْ أَمِنتُم مَّن فِي السَّمَاءِ أَن يُرْسِلَ عَلَيْكُمْ حَاصِبًا ۖ فَسَتَعْلَمُونَ كَيْفَ نَذِيرِ (17) وَلَقَدْ كَذَّبَ الَّذِينَ مِن قَبْلِهِمْ فَكَيْفَ كَانَ نَكِيرِ (18) أَوَلَمْ يَرَوْا إِلَى الطَّيْرِ فَوْقَهُمْ صَافَّاتٍ وَيَقْبِضْنَ ۚ مَا يُمسِكُهُنَّ إِلَّا الرَّحْمَٰنُ ۚ إِنَّهُ بِكُلِّ شَيْءٍ بَصِيرٌ (19) أَمَّنْ هَٰذَا الَّذِي هُوَ جُندٌ لَّكُم يَنصُرُكُم مِّن دُونِ الرَّحْمَٰنِ ۚ إِنِ الْكَافِرُونَ إِلَّا فِي غُرُورٍ (20) أَمَّنْ هَٰذَا الَّذِي يَرْزُقُكُمْ إِنْ أَمْسَكَ رِزْقَهُ ۚ بَل لَّجُّوا فِي عُتُوٍّ وَنُفُورٍ (21) أَفَمَن يَمْشِي مُكِبًّا عَلَىٰ وَجْهِهِ أَهْدَىٰ أَمَّن يَمْشِي سَوِيًّا عَلَىٰ صِرَاطٍ مُّسْتَقِيمٍ (22) قُلْ هُوَ الَّذِي أَنشَأَكُمْ وَجَعَلَ لَكُمُ السَّمْعَ وَالْأَبْصَارَ وَالْأَفْئِدَةَ ۖ قَلِيلًا مَّا تَشْكُرُونَ (23) قُلْ هُوَ الَّذِي ذَرَأَكُمْ فِي الْأَرْضِ وَإِلَيْهِ تُحْشَرُونَ (24) وَيَقُولُونَ مَتَىٰ هَٰذَا الْوَعْدُ إِن كُنتُمْ صَادِقِينَ (25) قُلْ إِنَّمَا الْعِلْمُ عِندَ اللَّهِ وَإِنَّمَا أَنَا نَذِيرٌ مُّبِينٌ (26) فَلَمَّا رَأَوْهُ زُلْفَةً سِيئَتْ وُجُوهُ الَّذِينَ كَفَرُوا وَقِيلَ هَٰذَا الَّذِي كُنتُم بِهِ تَدَّعُونَ (27) قُلْ أَرَأَيْتُمْ إِنْ أَهْلَكَنِيَ اللَّهُ وَمَن مَّعِيَ أَوْ رَحِمَنَا فَمَن يُجِيرُ الْكَافِرِينَ مِنْ عَذَابٍ أَلِيمٍ (28) قُلْ هُوَ الرَّحْمَٰنُ آمَنَّا بِهِ وَعَلَيْهِ تَوَكَّلْنَا ۖ فَسَتَعْلَمُونَ مَنْ هُوَ فِي ضَلَالٍ مُّبِينٍ (29) قُلْ أَرَأَيْتُمْ إِنْ أَصْبَحَ مَاؤُكُمْ غَوْرًا فَمَن يَأْتِيكُم بِمَاءٍ مَّعِينٍ (30)" }
        ];

        function initSadaqah() {
            const deceasedDuasList = document.getElementById('deceased-duas-list');
            deceasedDuas.forEach(dua => {
                const duaElement = document.createElement('div');
                duaElement.className = 'bg-green-50 p-4 rounded-lg shadow-inner text-center amiri-font text-lg';
                duaElement.innerText = dua;
                deceasedDuasList.appendChild(duaElement);
            });

            const deceasedSurahsList = document.getElementById('deceased-surahs-list');
            deceasedSurahs.forEach(surah => {
                const surahElement = document.createElement('div');
                surahElement.className = 'bg-green-50 p-4 rounded-lg shadow-inner text-center amiri-font text-lg';
                surahElement.innerHTML = `<h4 class="font-bold text-green-700 mb-2">${surah.name}</h4><p>${surah.text}</p>`;
                deceasedSurahsList.appendChild(surahElement);
            });
        }

        let istighfarCount = 0;
        const istighfarCounterElement = document.getElementById('istighfar-counter');

        function incrementIstighfar() {
            istighfarCount++;
            istighfarCounterElement.innerText = istighfarCount;
        }

        function resetIstighfar() {
            istighfarCount = 0;
            istighfarCounterElement.innerText = istighfarCount;
        }

        // --- Prayer Times Section ---
        const prayerTimesContainer = document.getElementById('prayer-times-container');
        const nextPrayerInfo = document.getElementById('next-prayer-info');
        
        async function initPrayerTimes() {
            try {
                const today = new Date();
                const year = today.getFullYear();
                const month = today.getMonth() + 1;
                const url = `https://api.aladhan.com/v1/calendarByCity?city=Cairo&country=Egypt&method=5&month=${month}&year=${year}`;
                const response = await fetch(url);
                const data = await response.json();
                
                if (data.data) {
                    const todayData = data.data[today.getDate() - 1];
                    const timings = todayData.timings;
                    renderPrayerTimes(timings);
                    setNextPrayerAlarm(timings);
                } else {
                    prayerTimesContainer.innerHTML = `<p class="text-red-600 text-center">لم يتم العثور على مواقيت الصلاة.</p>`;
                }
            } catch (error) {
                console.error('Error fetching prayer times:', error);
                prayerTimesContainer.innerHTML = `<p class="text-red-600 text-center">حدث خطأ أثناء تحميل مواقيت الصلاة. يرجى المحاولة لاحقاً.</p>`;
            }
        }

        function renderPrayerTimes(timings) {
            prayerTimesContainer.innerHTML = '';
            const prayerNames = {
                Fajr: "الفجر",
                Sunrise: "الشروق",
                Dhuhr: "الظهر",
                Asr: "العصر",
                Maghrib: "المغرب",
                Isha: "العشاء"
            };
            for (const key in prayerNames) {
                const box = document.createElement('div');
                box.className = 'prayer-time-box';
                box.innerHTML = `
                    <p class="font-bold text-lg mb-1">${prayerNames[key]}</p>
                    <p class="text-2xl">${timings[key].split(' ')[0]}</p>
                `;
                prayerTimesContainer.appendChild(box);
            }
        }

        function setNextPrayerAlarm(timings) {
            const now = new Date();
            const prayerOrder = ["Fajr", "Dhuhr", "Asr", "Maghrib", "Isha"];
            let nextPrayer = null;

            for (const prayer of prayerOrder) {
                const [hours, minutes] = timings[prayer].split(' ')[0].split(':').map(Number);
                const prayerTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), hours, minutes, 0);

                if (now < prayerTime) {
                    nextPrayer = { name: prayer, time: prayerTime };
                    break;
                }
            }
            
            if (nextPrayer) {
                const nextPrayerName = {
                    Fajr: "الفجر",
                    Dhuhr: "الظهر",
                    Asr: "العصر",
                    Maghrib: "المغرب",
                    Isha: "العشاء"
                }[nextPrayer.name];
                
                const timeDiff = nextPrayer.time.getTime() - now.getTime();
                const minutesLeft = Math.floor(timeDiff / (1000 * 60));
                const hoursLeft = Math.floor(minutesLeft / 60);
                const remainingMinutes = minutesLeft % 60;
                
                nextPrayerInfo.innerText = `الصلاة القادمة: ${nextPrayerName} بعد ${hoursLeft} ساعة و ${remainingMinutes} دقيقة.`;
                
                setTimeout(() => {
                    const alarmMessage = document.getElementById('alarm-message');
                    const alarmType = document.getElementById('alarm-type');
                    alarmType.innerText = `صلاة ${nextPrayerName}`;
                    alarmMessage.classList.remove('hidden');
                    setTimeout(() => alarmMessage.classList.add('hidden'), 10000);
                    setNextPrayerAlarm(timings);
                }, timeDiff);
            } else {
                nextPrayerInfo.innerText = "لا توجد صلوات قادمة اليوم.";
                setTimeout(initPrayerTimes, 1000 * 60 * 60);
            }
        }
    </script>
</body>
</html>
